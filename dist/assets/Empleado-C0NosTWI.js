import{i as H,r as o,j as e}from"./index-DM_27y1d.js";const G="_container_qk01v_3",$="_title_qk01v_17",Y="_formSection_qk01v_31",z="_form_qk01v_31",M="_input_qk01v_63",V="_button_qk01v_91",J="_buttonSecondary_qk01v_121",K="_buttonEdit_qk01v_137",Q="_buttonDanger_qk01v_153",X="_listSection_qk01v_171",Z="_empleadoList_qk01v_185",ee="_empleadoItem_qk01v_197",ae="_empleadoText_qk01v_211",le="_link_qk01v_221",te="_actions_qk01v_241",se="_modalOverlay_qk01v_255",ne="_modalWindow_qk01v_281",oe="_modalClose_qk01v_299",re="_modalTitle_qk01v_317",ie="_modalActions_qk01v_327",ce="_configAlert_qk01v_345",de="_fileUploadSection_qk01v_375",me="_fileLabel_qk01v_383",pe="_fileInput_qk01v_397",ue="_fileHint_qk01v_435",_e="_previewContainer_qk01v_451",ve="_imagePreviewWrapper_qk01v_473",ge="_imagePreview_qk01v_473",he="_removePreviewBtn_qk01v_507",Ne="_separator_qk01v_561",xe="_urlHint_qk01v_609",fe="_uploadProgress_qk01v_625",be="_progressBar_qk01v_647",je="_progressFill_qk01v_663",Ce="_empleadoImageContainer_qk01v_691",Ee="_empleadoImage_qk01v_691",ke="_empleadoInfo_qk01v_721",we="_currentImageContainer_qk01v_761",Ie="_currentImage_qk01v_761",a={container:G,title:$,formSection:Y,form:z,input:M,button:V,buttonSecondary:J,buttonEdit:K,buttonDanger:Q,listSection:X,empleadoList:Z,empleadoItem:ee,empleadoText:ae,link:le,actions:te,modalOverlay:se,modalWindow:ne,modalClose:oe,modalTitle:re,modalActions:ie,configAlert:ce,fileUploadSection:de,fileLabel:me,fileInput:pe,fileHint:ue,previewContainer:_e,imagePreviewWrapper:ve,imagePreview:ge,removePreviewBtn:he,separator:Ne,urlHint:xe,uploadProgress:fe,progressBar:be,progressFill:je,empleadoImageContainer:Ce,empleadoImage:Ee,empleadoInfo:ke,currentImageContainer:we,currentImage:Ie},ye=()=>{const{addEmpleado:q,fetchEmpleado:p,empleados:y,deleteEmpleado:U,updateEmpleado:S}=H(),[j,v]=o.useState(null),[c,C]=o.useState({Nombre_Empleado:"",NumCelular:"",URL:""}),[i,E]=o.useState({Nombre_Empleado:"",NumCelular:"",URL:""}),[u,g]=o.useState(null),[s,_]=o.useState(!1),[k,h]=o.useState(""),[N,d]=o.useState(null),[x,m]=o.useState(""),L="bradatec",P="davbpytad";o.useEffect(()=>{p()},[p]);const R=l=>{const t=l.target.files[0];if(t){g(t);const n=new FileReader;n.onload=r=>h(r.target.result),n.readAsDataURL(t)}},D=l=>{const t=l.target.files[0];if(t){d(t);const n=new FileReader;n.onload=r=>m(r.target.result),n.readAsDataURL(t)}},w=async l=>{const t=new FormData;t.append("file",l),t.append("upload_preset",L);try{const n=await fetch(`https://api.cloudinary.com/v1_1/${P}/image/upload`,{method:"POST",body:t});if(!n.ok)throw new Error("Error al subir imagen a Cloudinary");return(await n.json()).secure_url}catch(n){throw console.error("Error en upload:",n),n}},f=l=>{const{name:t,value:n}=l.target;C(r=>({...r,[t]:n}))},A=async l=>{l.preventDefault(),_(!0);try{let t={...c};if(u){const r=await w(u);t.URL=r}await q(t),C({Nombre_Empleado:"",NumCelular:"",URL:""}),g(null),h("");const n=document.querySelector('input[type="file"]');n&&(n.value="")}catch(t){console.error("Error al agregar empleado:",t),alert("Error al subir la imagen. Por favor, verifica tu configuración de Cloudinary.")}finally{_(!1)}},F=async l=>{window.confirm("¿Estás seguro de eliminar este empleado?")&&(await U(l),p())},O=l=>{v(l),E({Nombre_Empleado:l.Nombre_Empleado,NumCelular:l.NumCelular,URL:l.URL}),d(null),m("")},b=l=>{E(t=>({...t,[l.target.name]:l.target.value}))},T=async()=>{_(!0);try{let l={...i};if(N){const t=await w(N);l.URL=t}await S(j.ID_Empleado,l),p(),v(null),d(null),m("")}catch(l){console.error("Error al actualizar empleado:",l),alert("Error al actualizar la imagen del empleado.")}finally{_(!1)}},I=()=>{v(null),d(null),m("")},B=()=>{g(null),h("");const l=document.querySelector('input[type="file"]');l&&(l.value="")},W=()=>{d(null),m("")};return e.jsxs("div",{className:a.container,children:[e.jsxs("div",{className:a.formSection,children:[e.jsx("h1",{className:a.title,children:"Agregar empleados"}),e.jsxs("div",{className:a.configAlert,children:[e.jsx("p",{children:e.jsx("strong",{children:"⚠️ Configuración necesaria:"})}),e.jsx("p",{children:"Asegúrate de configurar tu CLOUDINARY_CLOUD_NAME y CLOUDINARY_UPLOAD_PRESET en el componente."})]}),e.jsxs("form",{onSubmit:A,className:a.form,children:[e.jsx("input",{type:"text",placeholder:"Nombre del empleado",required:!0,name:"Nombre_Empleado",value:c.Nombre_Empleado,onChange:f,className:a.input,disabled:s}),e.jsx("input",{type:"text",placeholder:"Número de celular",required:!0,name:"NumCelular",value:c.NumCelular,onChange:f,className:a.input,disabled:s}),e.jsxs("div",{className:a.fileUploadSection,children:[e.jsx("label",{className:a.fileLabel,children:"Foto del empleado"}),e.jsx("input",{type:"file",accept:"image/*",onChange:R,className:a.fileInput,disabled:s}),e.jsx("p",{className:a.fileHint,children:"Selecciona una imagen (JPG, PNG, GIF, etc.)"})]}),k&&e.jsxs("div",{className:a.previewContainer,children:[e.jsx("label",{children:"Vista previa:"}),e.jsxs("div",{className:a.imagePreviewWrapper,children:[e.jsx("img",{src:k,alt:"Preview",className:a.imagePreview}),e.jsx("button",{type:"button",onClick:B,className:a.removePreviewBtn,disabled:s,children:"❌"})]})]}),e.jsx("div",{className:a.separator,children:e.jsx("span",{children:"O"})}),e.jsx("input",{type:"url",placeholder:"URL de imagen (opcional)",name:"URL",value:c.URL,onChange:f,className:a.input,disabled:s||u!==null}),e.jsx("p",{className:a.urlHint,children:"Solo se usará si no has seleccionado un archivo"}),s&&e.jsxs("div",{className:a.uploadProgress,children:[e.jsx("p",{children:"Subiendo datos del empleado..."}),e.jsx("div",{className:a.progressBar,children:e.jsx("div",{className:a.progressFill})})]}),e.jsx("button",{type:"submit",className:a.button,disabled:s||!u&&!c.URL,children:s?"Guardando...":"Guardar Datos"})]})]}),e.jsxs("div",{className:a.listSection,children:[e.jsx("h1",{className:a.title,children:"Lista de empleados"}),e.jsx("div",{className:a.empleadoList,children:y.map(l=>e.jsxs("div",{className:a.empleadoItem,children:[l.URL&&e.jsx("div",{className:a.empleadoImageContainer,children:e.jsx("img",{src:l.URL,alt:l.Nombre_Empleado,className:a.empleadoImage,onError:t=>{t.target.style.display="none"}})}),e.jsxs("div",{className:a.empleadoInfo,children:[e.jsxs("p",{className:a.empleadoText,children:[e.jsx("strong",{children:"Nombre:"})," ",l.Nombre_Empleado]}),e.jsxs("p",{className:a.empleadoText,children:[e.jsx("strong",{children:"Teléfono:"})," ",l.NumCelular]}),l.URL&&e.jsxs("p",{className:a.empleadoText,children:[e.jsx("strong",{children:"Imagen:"}),e.jsx("a",{href:l.URL,target:"_blank",rel:"noopener noreferrer",className:a.link,children:"Ver imagen completa"})]})]}),e.jsxs("div",{className:a.actions,children:[e.jsx("button",{onClick:()=>F(l.ID_Empleado),className:`${a.button} ${a.buttonDanger}`,disabled:s,children:"Eliminar"}),e.jsx("button",{onClick:()=>O(l),className:`${a.button} ${a.buttonEdit}`,disabled:s,children:"Editar"})]})]},l.ID_Empleado))}),j&&e.jsx("div",{className:a.modalOverlay,children:e.jsxs("div",{className:a.modalWindow,children:[e.jsx("span",{className:a.modalClose,onClick:I,children:"×"}),e.jsx("h3",{className:a.modalTitle,children:"Editar empleado"}),e.jsx("input",{type:"text",name:"Nombre_Empleado",value:i.Nombre_Empleado,onChange:b,placeholder:"Nombre del empleado",className:a.input,disabled:s}),e.jsx("input",{type:"text",name:"NumCelular",value:i.NumCelular,onChange:b,placeholder:"Número de celular",className:a.input,disabled:s}),i.URL&&!x&&e.jsxs("div",{className:a.currentImageContainer,children:[e.jsx("label",{children:"Imagen actual:"}),e.jsx("img",{src:i.URL,alt:"Imagen actual",className:a.currentImage})]}),e.jsxs("div",{className:a.fileUploadSection,children:[e.jsx("label",{children:"Cambiar foto del empleado"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D,className:a.fileInput,disabled:s})]}),x&&e.jsxs("div",{className:a.previewContainer,children:[e.jsx("label",{children:"Nueva imagen:"}),e.jsxs("div",{className:a.imagePreviewWrapper,children:[e.jsx("img",{src:x,alt:"Preview",className:a.imagePreview}),e.jsx("button",{type:"button",onClick:W,className:a.removePreviewBtn,disabled:s,children:"❌"})]})]}),e.jsx("div",{className:a.separator,children:e.jsx("span",{children:"O"})}),e.jsx("input",{type:"url",name:"URL",value:i.URL,onChange:b,placeholder:"URL de imagen",className:a.input,disabled:s||N!==null}),s&&e.jsxs("div",{className:a.uploadProgress,children:[e.jsx("p",{children:"Actualizando empleado..."}),e.jsx("div",{className:a.progressBar,children:e.jsx("div",{className:a.progressFill})})]}),e.jsxs("div",{className:a.modalActions,children:[e.jsx("button",{onClick:T,className:a.button,disabled:s,children:s?"Guardando...":"Guardar"}),e.jsx("button",{onClick:I,className:`${a.button} ${a.buttonSecondary}`,disabled:s,children:"Cancelar"})]})]})})]})]})};export{ye as default};
